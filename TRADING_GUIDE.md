# CTP交易系统功能使用指南

## 界面布局

### 第一行 - 连接信息
- **经纪商ID**: 默认 1010
- **用户ID**: 您的账户ID
- **密码**: 交易密码
- **交易前置**: CTP交易服务器地址
- **认证码**: API认证码
- **连接登录**: 点击此按钮连接服务器并登录

### 第二行 - 查询功能
- **查询委托**: 查询当日所有委托单（包括已成交、未成交、已撤销等）
- **查询持仓**: 查询当前持仓情况（多头、空头、持仓量、盈亏等）
- **查询行情**: 查询指定合约的行情快照（需输入合约代码）
- **查询合约**: 查询所有可交易合约（自动过滤已过期合约，按到期日排序）

### 第三行 - 交易功能
- **合约代码**: 输入要交易的合约代码（如 cu2602, IF2601）
- **价格**: 输入限价单价格
- **手数**: 输入交易手数（默认为1）
- **买开**: 买入开仓（做多）
- **卖开**: 卖出开仓（做空）
- **买平**: 买入平仓（平空头）
- **卖平**: 卖出平仓（平多头）
- **撤单**: 撤销委托（需先查询委托获取信息）

## 使用流程

### 1. 连接登录
1. 确认连接信息正确（经纪商ID、用户ID、密码、前置地址、认证码）
2. 点击"连接登录"按钮
3. 等待状态栏显示"登录成功"

### 2. 查询合约信息
1. 点击"查询合约"按钮
2. 系统会显示所有未过期的期货合约，按到期日排序
3. 点击任意合约行，合约代码会自动填入"合约代码"输入框

### 3. 查询行情
1. 在"合约代码"输入框中输入合约代码（或从合约列表中选择）
2. 点击"查询行情"按钮
3. 查看行情数据（最新价、开盘价、最高价、最低价、成交量等）

### 4. 下单交易
**开仓示例（买入开仓）：**
1. 在"合约代码"输入框输入：`cu2602`
2. 在"价格"输入框输入：`75000`
3. 在"手数"输入框输入：`1`
4. 点击"买开"按钮
5. 在确认对话框中核对信息后点击"确定"
6. 等待系统回报

**平仓示例（卖出平仓）：**
1. 先点击"查询持仓"确认有多头持仓
2. 在"合约代码"输入框输入要平仓的合约
3. 输入平仓价格和手数
4. 点击"卖平"按钮
5. 确认并提交

### 5. 查询委托和持仓
- **查询委托**: 随时点击查看当日所有报单情况
- **查询持仓**: 查看当前持仓的详细信息（持仓量、均价、盈亏）

### 6. 撤单操作
1. 点击"查询委托"查看待成交的委托
2. 记录需要撤销的委托信息（交易所、报单编号等）
3. 目前版本需要手动记录信息后进行撤单

## 交易方向说明

| 按钮 | 方向 | 开平 | 说明 |
|------|------|------|------|
| 买开 | 买入 | 开仓 | 建立多头仓位（看涨） |
| 卖开 | 卖出 | 开仓 | 建立空头仓位（看跌） |
| 买平 | 买入 | 平仓 | 平掉空头仓位（原来做空，现在买入平仓） |
| 卖平 | 卖出 | 平仓 | 平掉多头仓位（原来做多，现在卖出平仓） |

## 交易回报说明

### 报单回报
- 系统会在状态栏显示报单状态
- 重要状态变化会弹出消息框通知

### 成交回报
- 成交后会弹出对话框显示成交详情
- 包括：合约、方向、价格、数量、成交时间
- 状态栏也会显示成交信息

### 错误处理
- 报单失败会显示错误原因
- 常见错误：
  - 未连接登录
  - 合约代码错误
  - 价格超出涨跌停范围
  - 保证金不足
  - 持仓不足（平仓时）

## 注意事项

1. **交易前确认**
   - 确保账户资金充足
   - 确认合约代码正确
   - 核对价格和数量
   - 理解开平仓方向

2. **风险控制**
   - 合理设置止损止盈
   - 不要过度交易
   - 注意保证金水平
   - 及时查询持仓和委托

3. **交易时间**
   - 日盘：09:00-15:00
   - 夜盘：21:00-02:30（部分品种）
   - 非交易时间无法下单

4. **系统限制**
   - 查询操作有频率限制（1秒1次）
   - 报单后系统会自动记录日志
   - 建议定期查询委托和持仓

## 日志说明

系统会自动记录操作日志到 `ctp_debug.log` 文件，包括：
- 连接登录信息
- 报单请求和响应
- 成交回报
- 错误信息

如遇问题，可查看日志文件排查原因。

## 技术支持

如有问题，请检查：
1. 网络连接是否正常
2. 账户信息是否正确
3. 是否在交易时间
4. 查看 ctp_debug.log 日志文件
5. 确认CTP API版本兼容性

---
**免责声明**: 期货交易有风险，入市需谨慎！本系统仅供学习和测试使用。
