# ⚠️ 紧急！程序被杀毒软件删除 - 立即操作指南

## 🔴 当前状态
- ❌ `CTP_Trader.exe` 被杀毒软件删除
- ❌ 自动添加排除项失败（错误代码 0x800106ba）
- ⚠️ 需要**手动**添加排除项

---

## 📋 立即操作步骤（请按顺序完成）

### 步骤1：确认您的杀毒软件

**检查您安装的杀毒软件**：
- [ ] Windows Defender（系统自带）
- [ ] 360安全卫士
- [ ] 火绒安全
- [ ] 腾讯电脑管家
- [ ] 卡巴斯基
- [ ] 其他：________

---

### 步骤2：添加排除项/信任区（选择对应的方式）

#### 🛡️ Windows Defender（推荐优先尝试）

**图形化操作步骤**：

```
1. 按键盘 Win + I 键
   ↓
2. 点击 [更新和安全]
   ↓
3. 点击左侧 [Windows 安全]
   ↓
4. 点击 [病毒和威胁防护]
   ↓
5. 点击 [管理设置]
   ↓
6. 向下滚动，找到 [排除项]
   ↓
7. 点击 [添加或删除排除项]
   ↓
8. 点击 [+ 添加排除项]
   ↓
9. 选择 [文件夹]
   ↓
10. 浏览到：D:\projects\other\cexsample\bin
   ↓
11. 点击 [选择文件夹]
   ↓
12. 完成！✅
```

**快速路径**：
```
设置 → 更新和安全 → Windows 安全 → 病毒和威胁防护 
→ 管理设置 → 排除项 → 添加排除项 → 文件夹
→ D:\projects\other\cexsample\bin
```

---

#### 🔷 360安全卫士

```
1. 打开 360安全卫士
   ↓
2. 点击 [病毒查杀]
   ↓
3. 点击右上角 [信任区]
   ↓
4. 点击 [添加目录]
   ↓
5. 选择：D:\projects\other\cexsample\bin
   ↓
6. 点击 [确定]
```

**额外操作**：
- 还需在 [隔离区] 中恢复被删除的 `CTP_Trader.exe`

---

#### 🔶 火绒安全

```
1. 打开火绒安全
   ↓
2. 点击右上角 [≡] 菜单
   ↓
3. 点击 [设置]
   ↓
4. 点击左侧 [信任区]
   ↓
5. 点击 [添加文件夹]
   ↓
6. 选择：D:\projects\other\cexsample\bin
   ↓
7. 点击 [确定]
```

---

#### 🔵 腾讯电脑管家

```
1. 打开腾讯电脑管家
   ↓
2. 点击 [病毒查杀]
   ↓
3. 点击 [信任区]
   ↓
4. 点击 [添加文件夹]
   ↓
5. 选择：D:\projects\other\cexsample\bin
   ↓
6. 点击 [确定]
```

---

### 步骤3：重新编译程序

**添加排除项后**，在 PowerShell 中执行：

```powershell
.\build.ps1
```

**预期结果**：
```
[1/4] Cleaning old files...
[2/4] Compiling ctp_trader.cpp...
[3/4] Compiling main.c...
[4/4] Linking...
==========================================
   Build Successful!
   Executable: bin\CTP_Trader.exe
==========================================
```

---

### 步骤4：验证程序未被删除

**等待 5 秒后检查**：

```powershell
Start-Sleep -Seconds 5
Test-Path "bin\CTP_Trader.exe"
```

**预期结果**：显示 `True`

如果显示 `False`，说明：
1. 排除项未生效（重新添加）
2. 或有其他杀毒软件也在运行

---

### 步骤5：运行程序

```powershell
.\run.bat
```

或直接双击：`bin\CTP_Trader.exe`

---

## 🔍 如何确认是哪个杀毒软件删除的？

### 检查系统中运行的安全软件：

```powershell
Get-Process | Where-Object {$_.Name -match '360|Huorong|QQ|Kasper|Defender'} | Select-Object Name, Company
```

### 检查 Windows Defender 状态：

```powershell
Get-Service -Name WinDefend
```

---

## ❓ 常见问题

### Q1: 添加排除项后还是被删除怎么办？

**可能原因**：
1. 有多个杀毒软件同时运行
2. 企业策略限制（公司电脑）
3. 家长控制功能开启

**解决方法**：
- 检查所有安全软件并逐一添加信任
- 卸载不必要的杀毒软件（避免冲突）
- 联系 IT 管理员（公司电脑）

### Q2: 如何找回被删除的程序？

**Windows Defender**：
```
Windows 安全 → 病毒和威胁防护 → 保护历史记录 
→ 找到被删除的文件 → 还原
```

**第三方杀毒软件**：
- 360：隔离区
- 火绒：隔离区
- 管家：隔离区

### Q3: 临时测试怎么办？

**不推荐，但可以临时禁用实时保护**：
1. Windows Defender：实时保护 → 关闭（15分钟后自动恢复）
2. 快速测试程序
3. 记得重新启用

---

## 🎯 重要提醒

✅ **这是误报，不是病毒！**
- 程序是您自己编译的
- 源代码完全可控
- 只是没有数字签名

✅ **只排除开发目录**
- 不要排除整个 C 盘或系统目录
- 只排除：`D:\projects\other\cexsample\bin`

✅ **生产环境建议**
- 给程序添加数字签名
- 使用代码签名证书
- 减少误报率

---

## 📞 仍然无法解决？

如果以上方法都无法解决：

1. **截图发送**：
   - 杀毒软件界面
   - 排除项设置截图
   - 错误信息截图

2. **提供信息**：
   - Windows 版本：`winver`
   - 杀毒软件名称和版本
   - 是否公司电脑

3. **临时方案**：
   - 在没有杀毒软件的虚拟机中测试
   - 使用 Windows Sandbox 测试

---

**操作完成后，请返回并告诉我结果！** ✅
